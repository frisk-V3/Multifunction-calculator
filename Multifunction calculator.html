<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>PC Scientific Calculator</title>
<style>
  body {
    background: #1e1e1e;
    color: #fff;
    font-family: Consolas, monospace;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
  }

  .calc {
    background: #2b2b2b;
    padding: 20px;
    border-radius: 12px;
    width: 420px;
    box-shadow: 0 0 20px rgba(0,0,0,0.6);
  }

  .display {
    width: 100%;
    height: 60px;
    font-size: 28px;
    padding: 10px;
    border: none;
    border-radius: 8px;
    background: #111;
    color: #0f0;
    text-align: right;
    margin-bottom: 15px;
  }

  .keys {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
  }

  button {
    padding: 16px;
    font-size: 18px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    background: #444;
    color: #fff;
    transition: 0.1s;
  }

  button:hover { background: #555; }
  button:active { transform: scale(0.97); }

  .op { background: #ff9500; }
  .fn { background: #666; }
  .equal { background: #1e90ff; }
  .wide { grid-column: span 2; }
</style>
</head>
<body>

<div class="calc">
  <input id="display" class="display" type="text" readonly>

  <div class="keys">
    <button class="fn" data-fn="AC">AC</button>
    <button class="fn" data-fn="DEL">DEL</button>
    <button class="fn" data-insert="(">(</button>
    <button class="fn" data-insert=")">)</button>

    <button class="fn" data-fn="sin">sin</button>
    <button class="fn" data-fn="cos">cos</button>
    <button class="fn" data-fn="tan">tan</button>
    <button class="fn" data-fn="sqrt">√</button>

    <button data-insert="7">7</button>
    <button data-insert="8">8</button>
    <button data-insert="9">9</button>
    <button class="op" data-insert="/">÷</button>

    <button data-insert="4">4</button>
    <button data-insert="5">5</button>
    <button data-insert="6">6</button>
    <button class="op" data-insert="*">×</button>

    <button data-insert="1">1</button>
    <button data-insert="2">2</button>
    <button data-insert="3">3</button>
    <button class="op" data-insert="-">−</button>

    <button data-insert="0" class="wide">0</button>
    <button data-insert=".">.</button>
    <button class="op" data-insert="+">+</button>

    <button class="equal wide" data-fn="=">=</button>
  </div>
</div>

<script>
  const display = document.getElementById("display");

  function insert(t) {
    display.value += t;
  }

  function calc() {
    let expr = display.value;

    expr = expr
      .replace(/√/g, "Math.sqrt")
      .replace(/sin\(/g, "Math.sin(")
      .replace(/cos\(/g, "Math.cos(")
      .replace(/tan\(/g, "Math.tan(");

    try {
      const result = Function('"use strict";return (' + expr + ')')();
      if (!isNaN(result)) display.value = result;
    } catch {
      display.value = "Error";
      setTimeout(() => display.value = "", 800);
    }
  }

  document.querySelector(".keys").addEventListener("click", e => {
    const b = e.target.closest("button");
    if (!b) return;

    const ins = b.dataset.insert;
    const fn = b.dataset.fn;

    if (ins) return insert(ins);

    if (fn) {
      switch (fn) {
        case "AC": display.value = ""; break;
        case "DEL": display.value = display.value.slice(0, -1); break;
        case "=": calc(); break;
        case "sin": insert("sin("); break;
        case "cos": insert("cos("); break;
        case "tan": insert("tan("); break;
        case "sqrt": insert("√("); break;
      }
    }
  });

  // PCキーボード対応
  document.addEventListener("keydown", e => {
    const k = e.key;

    if ((k >= "0" && k <= "9") || "+-*/().".includes(k)) {
      insert(k);
    } else if (k === "Enter") {
      e.preventDefault();
      calc();
    } else if (k === "Backspace") {
      display.value = display.value.slice(0, -1);
    } else if (k === "Escape") {
      display.value = "";
    }
  });
</script>

</body>
</html>
